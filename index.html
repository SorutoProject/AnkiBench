<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<script src="ankibench.builder.js"></script>
	<script src="sheetjs/xlsx.full.min.js"></script>
	<script>
	document.addEventListener("DOMContentLoaded", function(){
		document.getElementById("import").addEventListener("change", function(e){
			const file = e.target.files[0];
			const reader = new FileReader();
			reader.onload = function(){
				const data = new Uint8Array(reader.result);
				const workbook = XLSX.read(data,{type:"array"});
				let exportXLSXJSON = {};
				workbook.SheetNames.forEach(function(sheetName){
					const roa = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName],{header:1});
					if(roa.length) exportXLSXJSON[sheetName] = roa;
				});
				
				let title;
				let author;
				let description;
				if(document.getElementById("title").value === "") title = "無題";
				else title = document.getElementById("title").value;
				if(document.getElementById("author").value === "") author = "名無し";
				else author = document.getElementById("author").value;
				if(document.getElementById("description").value === "") description = "なし";
				else description = document.getElementById("description").value;
				
				const date = new Date();
				const dateText = date.getFullYear() + "/" + parseInt(date.getMonth() + 1) + "/" + date.getDate() + " " + date.getHours() + ":" + date.getMinutes()
				
				const ankiBenchHTML = ankibenchBuilder({
					"properties":{
						"title":title,
						"author":author,
						"createdOn":dateText,
						"description":description
					},
					"data":exportXLSXJSON
				});
				
				//generate blob
				const blob = new Blob([ankiBenchHTML], {"type":"text/html"});
				document.getElementById("linkfield").innerHTML = `<a href="${window.URL.createObjectURL(blob)}" target="_blank">今すぐ暗記を開始</a><br><a href="${window.URL.createObjectURL(blob)}" download="${title}.ankibench.html">ダウンロード</a>`;
				
				
			}
			reader.readAsArrayBuffer(file);
		});
	});
	</script>
	<title>AnkiBench</title>
</head>
<body>
<div class="markdown-body" style="padding: 0px 5px;">
            <h1 style="font-weight: 700; border-bottom: 1px solid rgb(170, 170, 170);">
              <a href="#AnkiBench" class="anchor" name="AnkiBench">
                <span class="header-link"></span>
              </a>
              AnkiBench
            </h1><p style="padding-bottom: 3px;">Webブラウザで動く、暗記ツール。<br>※このドキュメントは(仮)状態です。今後見やすいように改良すると思います。</p>
<p style="padding-bottom: 3px;">このページの案内に従って操作すると、忘却曲線の考え方に基づいた暗記ツールである、<strong>AnkiBench</strong>を利用できます！</p>

            <h2 style="font-weight: 700; border-bottom: 1px solid rgb(170, 170, 170);">
              <a href="#手順" class="anchor" name="手順">
                <span class="header-link"></span>
              </a>
              手順
            </h2><ol>
<li><p style="padding-bottom: 3px;">Excelなどの表計算アプリを用いて、A列に問題、B列に答えを書きます。</p>
<ul>
<li>A列(問題)に英単語などを書くと、「英単語暗記モード」、それ以外の場合は、「通常暗記モード」で表示されます。</li>
<li>答えが複数ある場合は、<code style="background: rgb(238, 238, 238) none repeat scroll 0% 0%; border-radius: 3px; font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Meiryo, monospace; padding: 0px 3px;">/</code>（スラッシュ)で区切ってください。</li>
<li><strong>ワークシート名</strong>が、「単元選択」画面で表示される単元名となります。</li>
<li>複数のワークシートを作成することで、複数の問題リストを作成できます。</li>
<li>例1(英単語暗記）<table style="border-collapse: collapse;">
<thead>
<tr>
<th style="border: 1px solid rgb(221, 221, 221); padding: 10px;" align="center"></th>
<th style="border: 1px solid rgb(221, 221, 221); padding: 10px;">A</th>
<th style="border: 1px solid rgb(221, 221, 221); padding: 10px;">B</th>
</tr>
</thead>
<tbody><tr>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;" align="center">1</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">dog</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">犬</td>
</tr>
<tr style="background-color: rgb(238, 238, 238);">
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;" align="center">2</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">beautiful</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">美しい</td>
</tr>
<tr>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;" align="center">3</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">have</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">持っている/食べる/所有している</td>
</tr>
</tbody></table>
</li>
<li>例2<table style="border-collapse: collapse;">
<thead>
<tr>
<th style="border: 1px solid rgb(221, 221, 221); padding: 10px;" align="center"></th>
<th style="border: 1px solid rgb(221, 221, 221); padding: 10px;">A</th>
<th style="border: 1px solid rgb(221, 221, 221); padding: 10px;">B</th>
</tr>
</thead>
<tbody><tr>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;" align="center">1</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">周期表を最初に作ったのは誰？</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">メンデレーエフ</td>
</tr>
<tr style="background-color: rgb(238, 238, 238);">
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;" align="center">2</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">一番軽い元素は？</td>
<td style="border: 1px solid rgb(221, 221, 221); padding: 10px;">水素</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p style="padding-bottom: 3px;">手順1で作成したデータをxlsx形式で保存してください。</p>
</li>
<li>
	<p>必要事項を入力してください。</p>
	<input type="text" placeholder="タイトル(例：英単語アプリ)" id="title" style="width:100%;height:30px;">
	<input type="text" placeholder="作者名" id="author" style="width:100%;height:30px;">
	<textarea id="description" placeholder="説明" style="width:100%;height:100px;resize:none;"></textarea>
	
</li>
<li><p style="padding-bottom: 3px;">手順2で保存したデータを下のボタンを押して出てきたダイアログから選択してください。</p>
<input type="file" id="import" accept=".xlsx"> </li>
<li><p style="padding-bottom: 3px;">この文の下にリンクが表示されたら、クリックしてください。ファイルがダウンロードされます。</p>
<div id="linkfield"></div></li>
<li><p style="padding-bottom: 3px;">ダウンロードされたファイルをブラウザで開くと、AnkiBenchが起動します。</p>
<ul>
<li>ファイルをサーバーにアップロードすれば、Web上で公開できます。</li>
</ul>
</li>
</ol>
</div>
</body>
</html>